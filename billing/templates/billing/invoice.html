{% extends "base.html" %}
{% block title %}Invoice #{{ purchase.id }}{% endblock %}
{% block content %}
<h2>Invoice #{{ purchase.id }}</h2>
<p><strong>Customer:</strong> {{ purchase.customer_email }}</p>
<p><strong>Date:</strong> {{ purchase.created_at }}</p>

<table class="table table-bordered mt-3">
  <thead><tr><th>Product</th><th>Qty</th><th>Unit</th><th>Tax%</th><th>Line Total</th></tr></thead>
  <tbody>
    {% for item in purchase.items.all %}
      <tr>
        <td>{{ item.product.name }} ({{ item.product.product_id }})</td>
        <td>{{ item.quantity }}</td>
        <td>₹{{ item.unit_price }}</td>
        <td>{{ item.tax_percentage }}</td>
        <td>₹{{ item.line_total }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<div class="mt-3">
  <p><strong>Subtotal:</strong> ₹{{ purchase.subtotal }}</p>
  <p><strong>Tax:</strong> ₹{{ purchase.tax_total }}</p>
  <p><strong>Total:</strong> ₹{{ purchase.total }}</p>
  <p><strong>Paid (assumed):</strong> ₹{{ purchase.paid_amount }}</p>
  <p><strong>Balance:</strong> ₹{{ purchase.balance }}</p>
</div>

{% if change_list %}
<h4>Change given</h4>
<ul>
  {% for c in change_list %}
    <li>₹{{ c.denomination_value }} x {{ c.count_given }}</li>
  {% endfor %}
</ul>
{% endif %}

<a href="{% url 'bill_history' %}" class="btn btn-secondary mt-3">Back to History</a>
{% endblock %}
